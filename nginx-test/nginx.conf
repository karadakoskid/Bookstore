events {
    worker_connections 1024;
}

http {
    upstream backend {
        server bookstore-backend-tlao.onrender.com:443;
    }
    
    upstream frontend {
        server YOUR_FRONTEND_NAME.onrender.com:443;
    }

    server {
        listen 8080;
        server_name bookstore.local;

        # API routes (similar to your ingress /api(/|$)(.*) rule)
        location ~ ^/api(/.*)?$ {
            proxy_pass https://backend$1;
            proxy_set_header Host bookstore-backend-tlao.onrender.com;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_ssl_server_name on;
        }

        # Frontend routes (similar to your ingress /(.*) rule)
        location / {
            proxy_pass https://frontend;
            proxy_set_header Host YOUR_FRONTEND_NAME.onrender.com;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_ssl_server_name on;
        }
    }
}
